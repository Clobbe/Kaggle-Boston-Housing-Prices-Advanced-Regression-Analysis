Kaggle Project : Boston Housing - Advanced Regression Techniques
================
Clobbe Norman
11/19/2017

Need to clean up this bulletlist later

-   Understand the problem We'll look at each variable and do a philosophical analysis about their meaning and importance for this problem.\*

-   Univariable study We'll just focus on the dependent variable ('SalePrice') and try to know a little bit more about it.

-   Multivariate study We'll try to understand how the dependent variable and independent variables relate.

-   Basic cleaning We'll clean the dataset and handle the missing data, outliers and categorical variables.

-   Test assumptions We'll check if our data meets the assumptions required by most multivariate techniques.

Pick up the right toolset
-------------------------

Meaning, importing the goodies from `tidyverse` for easy data wrangling, `ggplot2` for some nice visualization and `broom` for making sure we don't miss anything while creating our models later on.

    ## Loading required package: ggplot2

    ## Loading required package: tidyverse

    ## ── Attaching packages ────────────────────────────────── tidyverse 1.2.1 ──

    ## ✔ tibble  1.3.4     ✔ purrr   0.2.4
    ## ✔ tidyr   0.7.2     ✔ dplyr   0.7.4
    ## ✔ readr   1.1.1     ✔ stringr 1.2.0
    ## ✔ tibble  1.3.4     ✔ forcats 0.2.0

    ## ── Conflicts ───────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

    ## Loading required package: broom

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   Id = col_integer(),
    ##   MSSubClass = col_integer(),
    ##   LotFrontage = col_integer(),
    ##   LotArea = col_integer(),
    ##   OverallQual = col_integer(),
    ##   OverallCond = col_integer(),
    ##   YearBuilt = col_integer(),
    ##   YearRemodAdd = col_integer(),
    ##   MasVnrArea = col_integer(),
    ##   BsmtFinSF1 = col_integer(),
    ##   BsmtFinSF2 = col_integer(),
    ##   BsmtUnfSF = col_integer(),
    ##   TotalBsmtSF = col_integer(),
    ##   `1stFlrSF` = col_integer(),
    ##   `2ndFlrSF` = col_integer(),
    ##   LowQualFinSF = col_integer(),
    ##   GrLivArea = col_integer(),
    ##   BsmtFullBath = col_integer(),
    ##   BsmtHalfBath = col_integer(),
    ##   FullBath = col_integer()
    ##   # ... with 17 more columns
    ## )

    ## See spec(...) for full column specifications.

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   Id = col_integer(),
    ##   MSSubClass = col_integer(),
    ##   LotFrontage = col_integer(),
    ##   LotArea = col_integer(),
    ##   OverallQual = col_integer(),
    ##   OverallCond = col_integer(),
    ##   YearBuilt = col_integer(),
    ##   YearRemodAdd = col_integer(),
    ##   MasVnrArea = col_integer(),
    ##   BsmtFinSF1 = col_integer(),
    ##   BsmtFinSF2 = col_integer(),
    ##   BsmtUnfSF = col_integer(),
    ##   TotalBsmtSF = col_integer(),
    ##   `1stFlrSF` = col_integer(),
    ##   `2ndFlrSF` = col_integer(),
    ##   LowQualFinSF = col_integer(),
    ##   GrLivArea = col_integer(),
    ##   BsmtFullBath = col_integer(),
    ##   BsmtHalfBath = col_integer(),
    ##   FullBath = col_integer()
    ##   # ... with 18 more columns
    ## )

    ## See spec(...) for full column specifications.

``` r
glimpse(df.train) #checking the structure of the data frame and it's variables
```

    ## Observations: 1,460
    ## Variables: 81
    ## $ Id            <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 1...
    ## $ MSSubClass    <int> 60, 20, 60, 70, 60, 50, 20, 60, 50, 190, 20, 60,...
    ## $ MSZoning      <chr> "RL", "RL", "RL", "RL", "RL", "RL", "RL", "RL", ...
    ## $ LotFrontage   <int> 65, 80, 68, 60, 84, 85, 75, NA, 51, 50, 70, 85, ...
    ## $ LotArea       <int> 8450, 9600, 11250, 9550, 14260, 14115, 10084, 10...
    ## $ Street        <chr> "Pave", "Pave", "Pave", "Pave", "Pave", "Pave", ...
    ## $ Alley         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
    ## $ LotShape      <chr> "Reg", "Reg", "IR1", "IR1", "IR1", "IR1", "Reg",...
    ## $ LandContour   <chr> "Lvl", "Lvl", "Lvl", "Lvl", "Lvl", "Lvl", "Lvl",...
    ## $ Utilities     <chr> "AllPub", "AllPub", "AllPub", "AllPub", "AllPub"...
    ## $ LotConfig     <chr> "Inside", "FR2", "Inside", "Corner", "FR2", "Ins...
    ## $ LandSlope     <chr> "Gtl", "Gtl", "Gtl", "Gtl", "Gtl", "Gtl", "Gtl",...
    ## $ Neighborhood  <chr> "CollgCr", "Veenker", "CollgCr", "Crawfor", "NoR...
    ## $ Condition1    <chr> "Norm", "Feedr", "Norm", "Norm", "Norm", "Norm",...
    ## $ Condition2    <chr> "Norm", "Norm", "Norm", "Norm", "Norm", "Norm", ...
    ## $ BldgType      <chr> "1Fam", "1Fam", "1Fam", "1Fam", "1Fam", "1Fam", ...
    ## $ HouseStyle    <chr> "2Story", "1Story", "2Story", "2Story", "2Story"...
    ## $ OverallQual   <int> 7, 6, 7, 7, 8, 5, 8, 7, 7, 5, 5, 9, 5, 7, 6, 7, ...
    ## $ OverallCond   <int> 5, 8, 5, 5, 5, 5, 5, 6, 5, 6, 5, 5, 6, 5, 5, 8, ...
    ## $ YearBuilt     <int> 2003, 1976, 2001, 1915, 2000, 1993, 2004, 1973, ...
    ## $ YearRemodAdd  <int> 2003, 1976, 2002, 1970, 2000, 1995, 2005, 1973, ...
    ## $ RoofStyle     <chr> "Gable", "Gable", "Gable", "Gable", "Gable", "Ga...
    ## $ RoofMatl      <chr> "CompShg", "CompShg", "CompShg", "CompShg", "Com...
    ## $ Exterior1st   <chr> "VinylSd", "MetalSd", "VinylSd", "Wd Sdng", "Vin...
    ## $ Exterior2nd   <chr> "VinylSd", "MetalSd", "VinylSd", "Wd Shng", "Vin...
    ## $ MasVnrType    <chr> "BrkFace", "None", "BrkFace", "None", "BrkFace",...
    ## $ MasVnrArea    <int> 196, 0, 162, 0, 350, 0, 186, 240, 0, 0, 0, 286, ...
    ## $ ExterQual     <chr> "Gd", "TA", "Gd", "TA", "Gd", "TA", "Gd", "TA", ...
    ## $ ExterCond     <chr> "TA", "TA", "TA", "TA", "TA", "TA", "TA", "TA", ...
    ## $ Foundation    <chr> "PConc", "CBlock", "PConc", "BrkTil", "PConc", "...
    ## $ BsmtQual      <chr> "Gd", "Gd", "Gd", "TA", "Gd", "Gd", "Ex", "Gd", ...
    ## $ BsmtCond      <chr> "TA", "TA", "TA", "Gd", "TA", "TA", "TA", "TA", ...
    ## $ BsmtExposure  <chr> "No", "Gd", "Mn", "No", "Av", "No", "Av", "Mn", ...
    ## $ BsmtFinType1  <chr> "GLQ", "ALQ", "GLQ", "ALQ", "GLQ", "GLQ", "GLQ",...
    ## $ BsmtFinSF1    <int> 706, 978, 486, 216, 655, 732, 1369, 859, 0, 851,...
    ## $ BsmtFinType2  <chr> "Unf", "Unf", "Unf", "Unf", "Unf", "Unf", "Unf",...
    ## $ BsmtFinSF2    <int> 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0,...
    ## $ BsmtUnfSF     <int> 150, 284, 434, 540, 490, 64, 317, 216, 952, 140,...
    ## $ TotalBsmtSF   <int> 856, 1262, 920, 756, 1145, 796, 1686, 1107, 952,...
    ## $ Heating       <chr> "GasA", "GasA", "GasA", "GasA", "GasA", "GasA", ...
    ## $ HeatingQC     <chr> "Ex", "Ex", "Ex", "Gd", "Ex", "Ex", "Ex", "Ex", ...
    ## $ CentralAir    <chr> "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y"...
    ## $ Electrical    <chr> "SBrkr", "SBrkr", "SBrkr", "SBrkr", "SBrkr", "SB...
    ## $ `1stFlrSF`    <int> 856, 1262, 920, 961, 1145, 796, 1694, 1107, 1022...
    ## $ `2ndFlrSF`    <int> 854, 0, 866, 756, 1053, 566, 0, 983, 752, 0, 0, ...
    ## $ LowQualFinSF  <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ GrLivArea     <int> 1710, 1262, 1786, 1717, 2198, 1362, 1694, 2090, ...
    ## $ BsmtFullBath  <int> 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, ...
    ## $ BsmtHalfBath  <int> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ FullBath      <int> 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 1, 3, 1, 2, 1, 1, ...
    ## $ HalfBath      <int> 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, ...
    ## $ BedroomAbvGr  <int> 3, 3, 3, 3, 4, 1, 3, 3, 2, 2, 3, 4, 2, 3, 2, 2, ...
    ## $ KitchenAbvGr  <int> 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, ...
    ## $ KitchenQual   <chr> "Gd", "TA", "Gd", "Gd", "Gd", "TA", "Gd", "TA", ...
    ## $ TotRmsAbvGrd  <int> 8, 6, 6, 7, 9, 5, 7, 7, 8, 5, 5, 11, 4, 7, 5, 5,...
    ## $ Functional    <chr> "Typ", "Typ", "Typ", "Typ", "Typ", "Typ", "Typ",...
    ## $ Fireplaces    <int> 0, 1, 1, 1, 1, 0, 1, 2, 2, 2, 0, 2, 0, 1, 1, 0, ...
    ## $ FireplaceQu   <chr> NA, "TA", "TA", "Gd", "TA", NA, "Gd", "TA", "TA"...
    ## $ GarageType    <chr> "Attchd", "Attchd", "Attchd", "Detchd", "Attchd"...
    ## $ GarageYrBlt   <int> 2003, 1976, 2001, 1998, 2000, 1993, 2004, 1973, ...
    ## $ GarageFinish  <chr> "RFn", "RFn", "RFn", "Unf", "RFn", "Unf", "RFn",...
    ## $ GarageCars    <int> 2, 2, 2, 3, 3, 2, 2, 2, 2, 1, 1, 3, 1, 3, 1, 2, ...
    ## $ GarageArea    <int> 548, 460, 608, 642, 836, 480, 636, 484, 468, 205...
    ## $ GarageQual    <chr> "TA", "TA", "TA", "TA", "TA", "TA", "TA", "TA", ...
    ## $ GarageCond    <chr> "TA", "TA", "TA", "TA", "TA", "TA", "TA", "TA", ...
    ## $ PavedDrive    <chr> "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y"...
    ## $ WoodDeckSF    <int> 0, 298, 0, 0, 192, 40, 255, 235, 90, 0, 0, 147, ...
    ## $ OpenPorchSF   <int> 61, 0, 42, 35, 84, 30, 57, 204, 0, 4, 0, 21, 0, ...
    ## $ EnclosedPorch <int> 0, 0, 0, 272, 0, 0, 0, 228, 205, 0, 0, 0, 0, 0, ...
    ## $ `3SsnPorch`   <int> 0, 0, 0, 0, 0, 320, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
    ## $ ScreenPorch   <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 176, 0, 0, 0...
    ## $ PoolArea      <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ PoolQC        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
    ## $ Fence         <chr> NA, NA, NA, NA, NA, "MnPrv", NA, NA, NA, NA, NA,...
    ## $ MiscFeature   <chr> NA, NA, NA, NA, NA, "Shed", NA, "Shed", NA, NA, ...
    ## $ MiscVal       <int> 0, 0, 0, 0, 0, 700, 0, 350, 0, 0, 0, 0, 0, 0, 0,...
    ## $ MoSold        <int> 2, 5, 9, 2, 12, 10, 8, 11, 4, 1, 2, 7, 9, 8, 5, ...
    ## $ YrSold        <int> 2008, 2007, 2008, 2006, 2008, 2009, 2007, 2009, ...
    ## $ SaleType      <chr> "WD", "WD", "WD", "WD", "WD", "WD", "WD", "WD", ...
    ## $ SaleCondition <chr> "Normal", "Normal", "Normal", "Abnorml", "Normal...
    ## $ SalePrice     <int> 208500, 181500, 223500, 140000, 250000, 143000, ...

``` r
df.test <- df.test %>% 
  unclass() %>% 
  as.data.frame()

df.train <- df.train %>% 
  unclass() %>% 
  as.data.frame()
```

above code part is ready

Look at the col names to find cool variables
--------------------------------------------

``` r
sort(colnames(df.train))
```

    ##  [1] "Alley"         "BedroomAbvGr"  "BldgType"      "BsmtCond"     
    ##  [5] "BsmtExposure"  "BsmtFinSF1"    "BsmtFinSF2"    "BsmtFinType1" 
    ##  [9] "BsmtFinType2"  "BsmtFullBath"  "BsmtHalfBath"  "BsmtQual"     
    ## [13] "BsmtUnfSF"     "CentralAir"    "Condition1"    "Condition2"   
    ## [17] "Electrical"    "EnclosedPorch" "ExterCond"     "Exterior1st"  
    ## [21] "Exterior2nd"   "ExterQual"     "Fence"         "FireplaceQu"  
    ## [25] "Fireplaces"    "Foundation"    "FullBath"      "Functional"   
    ## [29] "GarageArea"    "GarageCars"    "GarageCond"    "GarageFinish" 
    ## [33] "GarageQual"    "GarageType"    "GarageYrBlt"   "GrLivArea"    
    ## [37] "HalfBath"      "Heating"       "HeatingQC"     "HouseStyle"   
    ## [41] "Id"            "KitchenAbvGr"  "KitchenQual"   "LandContour"  
    ## [45] "LandSlope"     "LotArea"       "LotConfig"     "LotFrontage"  
    ## [49] "LotShape"      "LowQualFinSF"  "MasVnrArea"    "MasVnrType"   
    ## [53] "MiscFeature"   "MiscVal"       "MoSold"        "MSSubClass"   
    ## [57] "MSZoning"      "Neighborhood"  "OpenPorchSF"   "OverallCond"  
    ## [61] "OverallQual"   "PavedDrive"    "PoolArea"      "PoolQC"       
    ## [65] "RoofMatl"      "RoofStyle"     "SaleCondition" "SalePrice"    
    ## [69] "SaleType"      "ScreenPorch"   "Street"        "TotalBsmtSF"  
    ## [73] "TotRmsAbvGrd"  "Utilities"     "WoodDeckSF"    "X1stFlrSF"    
    ## [77] "X2ndFlrSF"     "X3SsnPorch"    "YearBuilt"     "YearRemodAdd" 
    ## [81] "YrSold"

We did some variable evaluation, tidious but very useful. It was done in a regular Google Spreadsheet.

From the initial evaluation with determine that some variables are more interesting for houses and some for apartment houses.

By following the recommendation from previous author we grouped variables into the three categories: \* building \* location \* space

``` r
df.train.segment.building <- df.train[,segment.building]
df.train.segment.location <- df.train[,segment.location]
df.train.segment.space <- df.train[,segment.space]
```

### Creating a linear model between each variable in each segment to find

Not sure yet wether to generate lm() first and then plot each model or create all plots with ggplot with lm() directely and then plot all with facet\_grid…

``` r
#df.segment.building.model <- data.frame(variable = colnames(df.train.segment.building), model = 'na', rsq = 'na')

#df.segment.location.model <- data.frame(variable = colnames(df.train.segment.location), model = 'na', rsq = 'na')

#df.segment.space.model <- data.frame(variable = colnames(df.train.segment.space), model = 'na', rsq = 'na')

# Code copy + pasted from DataCamp to gen
# multiple plots, maybe it's possible to gen models with purrr-package?
# library(plyr)
# my_plots <- dlply(mtcars, .(cyl), function(df){
#   ggplot(df, aes(mpg, wt)) +
#     geom_point() +
#     xlim(range(mtcars$mpg)) +
#     ylim(range(mtcars$wt)) +
#     ggtitle(paste(df$cyl[1], 'cylinders'))
# })
# 
# 
# models <- by_country %>% 
#   mutate(model = map(data, country_model)) %>%
#   # model results are summarised in tidy dataframes using broom
#   mutate(glance = map(model, broom::glance),
#          rsq    = glance %>% map_dbl("r.squared"),
#          tidy   = map(model, broom::tidy),
#          augment= map(model, broom::augment))
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
